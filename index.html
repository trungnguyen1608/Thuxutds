<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Rate & Xu Member</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    h1 { color: #333; }
    table { border-collapse: collapse; width: 80%; margin-bottom: 20px; }
    th, td { border: 1px solid #999; padding: 8px; text-align: center; }
    th { background: #f0f0f0; }
    tfoot td { font-weight: bold; background: #e8e8e8; }
  </style>
</head>
<body>
  <h1>üìä B·∫£ng Rate & Xu Member</h1>

  <h2>üí≥ T√†i kho·∫£n Traodoisub</h2>
  <table id="tdsTable">
    <thead>
      <tr>
        <th>STT</th>
        <th>T√™n User</th>
        <th>S·ªë Xu</th>
        <th>Gi√° tr·ªã (VNƒê)</th>
      </tr>
    </thead>
    <tbody></tbody>
    <tfoot>
      <tr>
        <td colspan="2">T·ªïng c·ªông</td>
        <td id="totalXu">0</td>
        <td id="totalVND">0</td>
      </tr>
    </tfoot>
  </table>

  <h2>üí∞ Rate h·ªá th·ªëng</h2>
  <table id="rateTable">
    <tr><th>H·ªá th·ªëng</th><th>Rate (VNƒê/1k xu)</th></tr>
  </table>

  <h2>üë§ Xu c·ªßa Member (local)</h2>
  <table id="memberTable">
    <tr><th>Member</th><th>S·ªë xu</th></tr>
  </table>

<script>
// ‚ö†Ô∏è Nh·∫≠p danh s√°ch token Traodoisub ·ªü ƒë√¢y
const TDS_TOKENS = [
  "TOKEN_ACC_1",
  "TOKEN_ACC_2",
  "TOKEN_ACC_3"
];

// D·ªØ li·ªáu tƒ©nh (rate + member)
const localData = {
  "rate": {
    "traodoisub": 9.5, // VNƒê cho 1 xu (9.5k / 1000 xu)
    "tuongtaccheo": 10.0
  },
  "members": [
    { "name": "Nampro", "xu": 900 },
    { "name": "H√†Linh", "xu": 1200 }
  ]
};

// Load nhi·ªÅu account TDS + t√≠nh t·ªïng xu + VNƒê
async function loadMultiProfile() {
  const tbody = document.querySelector("#tdsTable tbody");
  let index = 1;
  let totalXu = 0;
  let totalVND = 0;
  const rate = localData.rate.traodoisub; // l·∫•y rate m·∫∑c ƒë·ªãnh TDS

  for (const token of TDS_TOKENS) {
    const url = `https://traodoisub.com/api/?fields=profile&access_token=${token}`;
    try {
      const resp = await fetch(url);
      const obj = await resp.json();

      if (obj.success === 200 && obj.data) {
        const profile = obj.data;
        const xu = profile.xu || 0;
        const vnd = Math.round((xu / 1000) * rate * 1000); // t√≠nh VNƒê

        totalXu += xu;
        totalVND += vnd;

        let row = `<tr>
          <td>${index++}</td>
          <td>${profile.user || profile.username || profile.name || "N/A"}</td>
          <td>${xu}</td>
          <td>${vnd.toLocaleString()} ƒë</td>
        </tr>`;
        tbody.innerHTML += row;
      } else {
        let row = `<tr>
          <td>${index++}</td>
          <td>L·ªói token/API</td>
          <td>-</td>
          <td>-</td>
        </tr>`;
        tbody.innerHTML += row;
        console.error("API l·ªói:", obj);
      }
    } catch (err) {
      let row = `<tr>
        <td>${index++}</td>
        <td>L·ªói fetch</td>
        <td>-</td>
        <td>-</td>
      </tr>`;
      tbody.innerHTML += row;
      console.error("Kh√¥ng fetch ƒë∆∞·ª£c profile:", err);
    }
  }

  // c·∫≠p nh·∫≠t t·ªïng xu + VNƒê
  document.getElementById("totalXu").innerText = totalXu;
  document.getElementById("totalVND").innerText = totalVND.toLocaleString() + " ƒë";
}

function loadLocalData() {
  // Hi·ªÉn th·ªã rate
  const rateTable = document.getElementById("rateTable");
  for (let key in localData.rate) {
    let row = `<tr><td>${key}</td><td>${localData.rate[key]}k / 1k xu</td></tr>`;
    rateTable.innerHTML += row;
  }

  // Hi·ªÉn th·ªã member
  const memberTable = document.getElementById("memberTable");
  localData.members.forEach(member => {
    let row = `<tr><td>${member.name}</td><td>${member.xu}</td></tr>`;
    memberTable.innerHTML += row;
  });
}

// G·ªçi khi load trang
window.onload = function() {
  loadMultiProfile();
  loadLocalData();
}
</script>
</body>
</html>
